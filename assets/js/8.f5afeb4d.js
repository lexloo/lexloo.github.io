(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{251:function(a,t,e){"use strict";e.r(t);var s=e(1),i=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"content"},[e("h1",{attrs:{id:"基于docker部署zabbix"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基于docker部署zabbix","aria-hidden":"true"}},[a._v("#")]),a._v(" 基于Docker部署Zabbix")]),a._v(" "),e("h2",{attrs:{id:"安装docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装docker","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装Docker")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("yum install docker\n\nsystemctl enable docker\n\nsystemctl start docker\n\ndocker -v\n")])])]),e("h2",{attrs:{id:"安装zabbix服务端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装zabbix服务端","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装Zabbix服务端")]),a._v(" "),e("p",[a._v("需要安装如下组件")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("组件名称")]),a._v(" "),e("th",[a._v("作用")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[a._v("数据库")]),a._v(" "),e("td",[a._v("MySQL")])]),a._v(" "),e("tr",[e("td",[a._v("Zabbix Java gateway")]),a._v(" "),e("td",[a._v("Java管理扩展，可以不添加")])]),a._v(" "),e("tr",[e("td",[a._v("Zabbix Server")]),a._v(" "),e("td",[a._v("zabbix服务端")])]),a._v(" "),e("tr",[e("td",[a._v("Zabbix Web")]),a._v(" "),e("td",[a._v("与MySQL服务器实例和Zabbix Server实例关联")])]),a._v(" "),e("tr",[e("td",[a._v("Zabbix agent")]),a._v(" "),e("td",[a._v("Zabbix客户端")])])])]),a._v(" "),e("h3",{attrs:{id:"mysql-数据库安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql-数据库安装","aria-hidden":"true"}},[a._v("#")]),a._v(" MySQL 数据库安装")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mkdir /docker/mysql -p\nvim Dockerfile\n")])])]),e("p",[a._v("修改时间，修改字符集")]),a._v(" "),e("p",[a._v("镜像内容")]),a._v(" "),e("blockquote",[e("p",[a._v("FROM mysql:5.7\nENV LANG en_US.utf8\nRUN ln -snf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && "),e("br"),a._v("\necho Asia/Shanghai > /etc/timezone "),e("br"),a._v("\n构建mysql镜像")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("docker build -t itek-mysql:5.7 .\ndocker images\n")])])]),e("p",[a._v("启动MySQL容器")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('docker run --hostname mysql --name itek-mysql-5.7 -t \\\n-e MYSQL_USER="zabbix" \\\n-e MYSQL_DATABASE="zabbix" \\\n-e MYSQL_PASSWORD="itek2019" \\\n-e MYSQL_ROOT_PASSWORD="itek20132019" \\\n-v /data/mysql:/var/lib/mysql:rw \\\n-d itek-mysql:5.7\n')])])]),e("p",[a._v("变量说明")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("变量")]),a._v(" "),e("th",{staticStyle:{"text-align":"left"}},[a._v("说明")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[a._v("MYSQL_USER")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("启动时要添加的用户")])]),a._v(" "),e("tr",[e("td",[a._v("MYSQL_DATABASE")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("启动时要创建的数据库")])]),a._v(" "),e("tr",[e("td",[a._v("MYSQL_PASSWORD")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("指定添加用的的密码")])]),a._v(" "),e("tr",[e("td",[a._v("MYSQL_ROOT_PASSWORD")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("root 用户的密码")])])])]),a._v(" "),e("p",[a._v("如果启动出错，注意")]),a._v(" "),e("p",[a._v("1.查看SELinux状态")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sestatus -v\ngetenforce\n")])])]),e("p",[a._v("2.临时关闭SELinux")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("setenforce 0\n")])])]),e("h3",{attrs:{id:"zabbix-java-gateway-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#zabbix-java-gateway-安装","aria-hidden":"true"}},[a._v("#")]),a._v(" Zabbix Java gateway 安装")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mkdir /docker/java-gateway -p\nvim Dockerfile\n")])])]),e("p",[a._v("修改时间，修改字符集")]),a._v(" "),e("p",[a._v("镜像内容")]),a._v(" "),e("blockquote",[e("p",[a._v("FROM zabbix/zabbix-java-gateway:latest\nENV LANG en_US.utf8\nRUN apk add -U tzdata\nRUN ln -snf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && "),e("br"),a._v("\necho Asia/Shanghai > /etc/timezone "),e("br"),a._v("\n构建镜像")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("docker build -t zabbix-java-gateway .\ndocker images\n")])])]),e("p",[a._v("启动容器")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("docker run --hostname zabbix-java-gateway \\\n--name zabbix-java-gateway -t \\\n-p 10052:10052 \\\n-d zabbix-java-gateway \n")])])]),e("h3",{attrs:{id:"zabbix-server-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#zabbix-server-安装","aria-hidden":"true"}},[a._v("#")]),a._v(" Zabbix Server 安装")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mkdir /docker/zabbix-server -p\nvim Dockerfile\n")])])]),e("p",[a._v("修改时间，修改字符集")]),a._v(" "),e("p",[a._v("镜像内容")]),a._v(" "),e("blockquote",[e("p",[a._v("FROM zabbix/zabbix-server-mysql:latest\nENV LANG en_US.utf8\nRUN apk add -U tzdata\nRUN ln -snf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && "),e("br"),a._v("\necho Asia/Shanghai > /etc/timezone \\")])]),a._v(" "),e("p",[a._v("构建镜像")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("docker build -t zabbix-server .\ndocker images\n")])])]),e("p",[a._v("启动容器")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('docker run --name zabbix-server -t \\\n> -p 10051:10051 \\\n> --hostname zabbix-server \\\n> -e DB_SERVER_HOST="itek-mysql-5.7" \\\n> -e MYSQL_DATABASE="zabbix" \\\n> -e MYSQL_USER="zabbix" \\\n> -e MYSQL_PASSWORD="itek2019" \\\n> -e MYSQL_ROOT_PASSWORD="itek20132019" \\\n> -e ZBX_JAVAGATEWAY="zabbix-java-gateway" \\\n> --link itek-mysql-5.7:mysql \\\n> --link zabbix-java-gateway:zabbix-java-gateway \\\n> -d zabbix-server\n')])])]),e("p",[a._v("变量说明")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("变量")]),a._v(" "),e("th",{staticStyle:{"text-align":"left"}},[a._v("说明")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[a._v("DB_SERVER_HOST")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("指定 MySQL 或 PostgreSQL 服务器的 IP 或 DNS 名称")])]),a._v(" "),e("tr",[e("td",[a._v("MYSQL_DATABASE")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("zabbix 数据库名称")])]),a._v(" "),e("tr",[e("td",[a._v("MYSQL_USER")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("数据库用户，默认是 zabbix")])]),a._v(" "),e("tr",[e("td",[a._v("MYSQL_PASSWORD")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("zabbix 数据库密码，默认 zabbix")])]),a._v(" "),e("tr",[e("td",[a._v("ZBX_JAVAGATEWAY")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("是否启用 Zabbix Java gateway，默认 false")])])])]),a._v(" "),e("h3",{attrs:{id:"zabbix-web-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#zabbix-web-安装","aria-hidden":"true"}},[a._v("#")]),a._v(" Zabbix Web 安装")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("mkdir /docker/zabbix-web -p\nvim Dockerfile\n")])])]),e("p",[a._v("修改时间，修改字符集")]),a._v(" "),e("p",[a._v("镜像内容")]),a._v(" "),e("blockquote",[e("p",[a._v("FROM zabbix/zabbix-web-nginx-mysql:latest\nENV LANG en_US.utf8\nRUN apk add -U tzdata\nRUN ln -snf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && "),e("br"),a._v("\necho Asia/Shanghai > /etc/timezone \\")])]),a._v(" "),e("p",[a._v("构建镜像")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("docker build -t zabbix-web .\ndocker images\n")])])]),e("p",[a._v("启动容器")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('docker run --name zabbix-web -t \\\n> -p 80:80 \\\n> --hostname zabbix-web \\\n> -e PHP_TZ="Asia/Shanghai" \\\n> -e DB_SERVER_HOST="itek-mysql-5.7" \\\n> -e MYSQL_DATABASE="zabbix" \\\n> -e MYSQL_USER="zabbix" \\\n> -e MYSQL_PASSWORD="itek2019" \\\n> -e MYSQL_ROOT_PASSWORD="itek20132019" \\\n> --link itek-mysql-5.7:mysql \\\n> --link zabbix-server:zabbix-server \\\n> -d zabbix-web\n')])])])])}],!1,null,null,null);t.default=i.exports}}]);